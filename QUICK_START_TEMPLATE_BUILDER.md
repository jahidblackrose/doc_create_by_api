# Template Builder - Quick Reference

## üöÄ Quick Start

### 1. Open Template Builder
```
http://localhost:5165/template-builder.html
```
Or click the **"üõ†Ô∏è Open Template Builder"** button in index.html

### 2. Create Your Word Template

Use placeholders like `{PropertyName}`:

```
APPLICANT DETAILS
================
Name: {ApplicantName}
Address: {ApplicantAddress}
Phone: {PhoneNumber}
Email: {EmailAddress}

LOAN DETAILS
=============
Loan Amount: Rs. {LoanAmount}
Interest Rate: {InterestRate}%
Term: {LoanTermMonths} months
Application Date: {ApplicationDate}

FOR: {BankName}
Date: {GeneratedDate}
Reference: {ReferenceNumber}
```

### 3. Upload & Configure

| Field | What to Enter | Example |
|-------|---------------|---------|
| Document Name | PascalCase name | `LoanApplicationForm` |
| Enum Value | Next number | `10` |

### 4. Copy Code to These Files

```
BankingDocumentAPI/Models/DocumentType.cs        ‚Üí Add enum value
BankingDocumentAPI/Models/[Name]Data.cs           ‚Üí Create model
BankingDocumentAPI/Services/WordDocumentService.cs ‚Üí Add method + case
BankingDocumentAPI/Templates/[Name].docx          ‚Üí Copy template
index.html                                        ‚Üí Add option
```

### 5. Build & Test

```bash
cd BankingDocumentAPI
dotnet build
dotnet run
```

---

## üìã Current Enum Values

```
0  = LoanProposal
1  = PromissoryNote
2  = LetterOfContinuity
3  = LetterOfRevival
4  = LetterOfArrangement
5  = StandingOrder
6  = LetterOfIndemnity
7  = LetterOfLien
8  = PersonalGuarantee
9  = UDC
10 = [YOUR NEW DOCUMENT] ‚Üê Use this
```

---

## üéØ Type Detection Reference

| Placeholder | Auto Type | Example Mock Value |
|------------|-----------|-------------------|
| `{Name}` | string | `"John Doe"` |
| `{Amount}` | decimal | `50000` |
| `{Date}` | DateTime | `DateTime.Now` |
| `{Age}` | int | `35` |
| `{IsActive}` | bool | `true` |
| `{Address}` | string | `"123 Main Street"` |
| `{Email}` | string | `"john@example.com"` |
| `{Phone}` | string | `"+880 1XXX-XXXXXX"` |
| `{Rate}` | decimal | `12.5m` |
| `{Term}` | int | `36` |

---

## üìÅ Files Generated by Template Builder

1. **DocumentType.cs** - Enum value addition
2. **[Name]Data.cs** - Complete model class
3. **WordDocumentService.cs** - Mock data + switch case
4. **index.html** - Dropdown option + array item
5. **API-README.md** - API documentation with examples

---

## üîó Links

- **Template Builder:** `template-builder.html`
- **Main Interface:** `index.html`
- **Full Guide:** `TEMPLATE_BUILDER_GUIDE.md`
- **Dev Guide:** `DEVELOPER.md`
- **API Docs:** `README.md`

---

## üí° Tips

- Use `{PropertyName}` format (PascalCase recommended)
- Common fields auto-included: `BankName`, `BranchName`, `ReferenceNumber`, `GeneratedDate`
- Click **Download All Files** to save generated code
- Copy button available for each file individually

---

## ‚ö†Ô∏è Common Issues

| Issue | Solution |
|-------|----------|
| No placeholders found | Use `{Name}` not `{name}` |
| Template not found | Copy .docx to `bin/Debug/net9.0/Templates/` |
| Build error | Check namespace matches `BankingDocumentAPI.Models` |
| Enum conflict | Use unique number (next highest + 1) |

---

## üìû API Call Example

```json
POST http://localhost:5165/api/document/generate

{
  "loanId": 12345,
  "documentType": 10,
  "outputFormat": 1
}
```

- `documentType: 10` = Your new document
- `outputFormat: 0` = DOCX
- `outputFormat: 1` = PDF
